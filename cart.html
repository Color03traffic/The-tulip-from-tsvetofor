<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–æ—Ä–∑–∏–Ω–∞ ‚Äî –¢—é–ª—å–ø–∞–Ω03</title>

  <link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="icon.png">
  <link rel="shortcut icon" type="image/png" href="favicon.png">

  <style>
    body{
      margin:0;
      font-family:system-ui,-apple-system,Roboto,Inter,sans-serif;
      background:#f4b6d2;
      color:#111;
    }
    .container{
      max-width:1100px;
      margin:0 auto;
      padding:16px;
    }
    header{
      margin-bottom:20px;
    }
    header .box{
      background:#fff;
      border:1px solid #e5e7eb;
      border-radius:14px;
      padding:16px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    h1{
      margin-top:0;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin-bottom:20px;
    }
    th,td{
      padding:10px;
      border-bottom:1px solid #ddd;
      text-align:left;
    }
    .qty-box{
      display:flex;
      align-items:center;
      gap:6px;
    }
    .qty-box input{
      width:70px;
      text-align:center;
      padding:4px;
      border-radius:6px;
      border:1px solid #aaa;
      font-size:16px;
    }
    button{
      cursor:pointer;
    }
    .btn{
      padding:10px 14px;
      border-radius:10px;
      border:0;
      font-weight:600;
      cursor:pointer;
    }
    .btn-green{background:#2ecc71;color:#fff;}
    .btn-blue{background:#3498db;color:#fff;}
    .btn-pink{background:#e84393;color:#fff;}
    .btn-white{background:#fff;color:#e84393;border:2px solid #e84393;}
    .inputs{
      margin:20px 0;
      padding:16px;
      background:#fff;
      border-radius:14px;
      border:1px solid #ddd;
      max-width:460px;
    }
    .inputs input{
      width:100%;
      margin-bottom:12px;
      padding:10px;
      border:1px solid #ccc;
      border-radius:10px;
      font-size:16px;
    }
  </style>
</head>

<body>
<div class="container">

  <!-- üî• –õ–û–ì–û–¢–ò–ü –í–ï–†–ù–£–¢ -->
  <header>
    <div class="box">
      <div style="font-size:22px;font-weight:800;display:flex;gap:6px;align-items:center;">
        üå∑ –¢—é–ª—å–ø–∞–Ω03
      </div>

      <nav>
        <a href="catalog.html" style="margin-left:18px;font-weight:500;">–ö–∞—Ç–∞–ª–æ–≥</a>
        <a href="index.html" style="margin-left:18px;font-weight:500;">–ì–ª–∞–≤–Ω–∞—è</a>
      </nav>
    </div>
  </header>

  <h1>–ö–æ—Ä–∑–∏–Ω–∞</h1>
  <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∞—Ç–Ω–æ 20 —à—Ç. –í—ã –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å –≤—Ä—É—á–Ω—É—é.</p>

  <table id="cartTable"></table>

  <h2 id="totalSum">–ò—Ç–æ–≥–æ: 0 ‚ÇΩ</h2>
  <p id="summary"></p>

  <div class="inputs">
    <h3>–î–∞–Ω–Ω—ã–µ –¥–ª—è —Å–≤—è–∑–∏</h3>
    <input id="fio" placeholder="–§–ò–û">
    <input id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
  </div>

  <button class="btn btn-white" onclick="location.href='catalog.html'">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥</button>
  <button class="btn btn-pink" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>

  <br><br>

  <button class="btn btn-green" onclick="sendWA()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ WhatsApp</button>
  <button class="btn btn-blue" onclick="sendTG()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram</button>

</div>

<script>
const PACK = 20;

function loadCart(){
  let cart = JSON.parse(localStorage.getItem("tulpan03_cart") || "[]");

  if(cart.length === 0){
    document.getElementById("cartTable").innerHTML = `<tr><td>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞.</td></tr>`;
    return;
  }

  let html = `
    <tr>
      <th>–¢–æ–≤–∞—Ä</th>
      <th>–¶–µ–Ω–∞ –∑–∞ —à—Ç.</th>
      <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
      <th>–°—É–º–º–∞</th>
    </tr>
  `;

  let total = 0;
  let smoothTotal = 0;
  let terryTotal = 0;
  let smoothQty = 0;
  let terryQty = 0;

  cart.forEach(item=>{
    let price = item.type === "terry" ? 87 : 75;
    let sum = price * item.qty;
    total += sum;

    if(item.type === "terry"){ terryQty += item.qty; terryTotal += sum; }
    else { smoothQty += item.qty; smoothTotal += sum; }

    html += `
      <tr>
        <td>${item.name}</td>
        <td>${price} ‚ÇΩ</td>
        <td>
          <div class="qty-box">
            <button onclick="chgQty('${item.name}',-PACK)">‚àí</button>
            <input id="qty_${item.name}" value="${item.qty}">
            <button onclick="chgQty('${item.name}',PACK)">+</button>
          </div>
        </td>
        <td>${sum} ‚ÇΩ</td>
      </tr>
    `;
  });

  document.getElementById("cartTable").innerHTML = html;
  document.getElementById("totalSum").innerText = "–ò—Ç–æ–≥–æ: " + total + " ‚ÇΩ";
  document.getElementById("summary").innerText =
    `–û–±—â–∏–π –æ–±—ä—ë–º ${smoothQty + terryQty} —à—Ç ` +
    `(–≥–ª–∞–¥–∫–∏–µ –∏ –º–∏–∫—Å: ${smoothQty} —à—Ç, –º–∞—Ö—Ä–æ–≤—ã–µ: ${terryQty} —à—Ç). ` +
    `–¶–µ–Ω–∞ –≥–ª–∞–¥–∫–∏—Ö –∏ –º–∏–∫—Å–∞: 75 ‚ÇΩ, –º–∞—Ö—Ä–æ–≤—ã—Ö: 87 ‚ÇΩ.`;
}

function chgQty(name,delta){
  let cart = JSON.parse(localStorage.getItem("tulpan03_cart") || "[]");
  let item = cart.find(i => i.name === name);
  if(!item) return;

  item.qty += delta;
  if(item.qty < PACK) item.qty = PACK;

  localStorage.setItem("tulpan03_cart", JSON.stringify(cart));
  loadCart();
}

function clearCart(){
  localStorage.removeItem("tulpan03_cart");
  loadCart();
}

function buildMessage(){
  let cart = JSON.parse(localStorage.getItem("tulpan03_cart") || "[]");
  if(cart.length === 0) return "";

  let msg = "–ó–∞–∫–∞–∑%20–¢—é–ª—å–ø–∞–Ω03:%0A";
  cart.forEach(i=>{
    msg += `${i.name}%20-%20${i.qty}%20—à—Ç%0A`;
  });

  return msg;
}

// üî• WHATSAPP —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
function sendWA(){
  let msg = buildMessage();
  window.open(
    "https://wa.me/79148416115?text=" + msg,
    "_blank"
  );
}

// üî• –ù–û–í–´–ô –†–ê–ë–û–ß–ò–ô TELEGRAM
function sendTG(){
  let msg = buildMessage();

  window.open(
    "https://t.me/share/url?url=Tulpan03&text=" + msg,
    "_blank"
  );
}

loadCart();
</script>

</body>
</html>
